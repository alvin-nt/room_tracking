(function(t){function e(e){for(var n,i,s=e[0],c=e[1],u=e[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(p.length)p.shift()();return a.push.apply(a,u||[]),o()}function o(){for(var t,e=0;e<a.length;e++){for(var o=a[e],n=!0,s=1;s<o.length;s++){var c=o[s];0!==r[c]&&(n=!1)}n&&(a.splice(e--,1),t=i(i.s=o[0]))}return t}var n={},r={zonePeopleHistorical:0},a=[];function i(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=n,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;a.push([1,"chunk-vendors"]),o()})({"035a":function(t,e,o){"use strict";o.d(e,"b",(function(){return n})),o.d(e,"a",(function(){return r})),o.d(e,"c",(function(){return a}));var n={day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"},r={day:"numeric",month:"short",year:"numeric"},a={hour:"2-digit",minute:"2-digit",second:"2-digit"}},"0e21":function(t,e,o){},1:function(t,e,o){t.exports=o("c486")},"144e":function(t,e,o){"use strict";o("a9e3");var n=o("035a");function r(t){if(!t)return"";if(t instanceof Date)return t.toLocaleString(n["b"]);try{return new Date(t).toLocaleString(n["b"])}catch(e){return"Invalid Date"}}function a(t){if(!t)return"";if(t instanceof Date)return t.toDateString(n["a"]);try{return new Date(t).toDateString(n["a"])}catch(e){return"Invalid Date"}}function i(t){if(!t)return"";if(t instanceof Date)return t.toTimeString(n["c"]);try{return new Date(t).toTimeString(n["c"])}catch(e){return"Invalid Time"}}function s(t){return t instanceof Number?t<0?"Invalid Hour":t<10?"0".concat(t,":00"):"".concat(t,":00"):"Invalid Hour"}e["a"]={filters:{formatDate:a,formatDateTime:r,formatTime:i,formatHour:s}}},"365c":function(t,e,o){"use strict";o.d(e,"a",(function(){return a})),o.d(e,"c",(function(){return w}));o("a4d3"),o("e01a"),o("99af"),o("d81d"),o("b0c0");var n=o("bc3a"),r=o.n(n),a={UNKNOWN:"U",UNAUTHORIZED:"A",OVERSTAY:"O"},i=Object({NODE_ENV:"production",BASE_URL:"/"}).API_BASE_URL||"http://localhost:3000";function s(){return r.a.get("".concat(i,"/zones")).then((function(t){return t.data}))}function c(t){return r.a.get("".concat(i,"/zones?name=").concat(t)).then((function(t){return t.data}))}function u(t,e){return r.a.get("".concat(i,"/zones/").concat(t,"/hourly-count?date=").concat(e)).then((function(t){return t.data}))}function l(t,e,o){return r.a.get("".concat(i,"/zones/").concat(t,"/people-within?ts_from=").concat(e,"&ts_to=").concat(o)).then((function(t){return t.data.map((function(t){return Object.assign(t,{from:new Date(t.from),to:t.to?new Date(t.to):null})}))}))}function d(t,e){return r.a.get("".concat(i,"/zones/").concat(t,"/people-within?date=").concat(e)).then((function(t){return t.data}))}function p(t){return r.a.get("".concat(i,"/zones/").concat(t,"/people")).then((function(t){return t.data}))}function f(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r.a.get("".concat(i,"/zones/alerts?zone_ids=").concat(t)).then((function(t){return t.data}))}function m(t){return r.a.post("".concat(i,"/zones/alerts/").concat(t),{is_dismissed:!0}).then((function(t){return t.data}))}function h(t){var e={id:t.id,name:t.name,description:t.description,config:{is_active:t.is_active,overstay_limit:t.overstay_limit},zone_group:t.zone_group_id};return r.a.post("".concat(i,"/zones"),e).then((function(t){return t.data})).then((function(t){return t.zone_group_id=t.zone_group.id,delete t.zone_group,t}))}function g(t,e){var o={id:e.id,name:e.name,description:e.description,config:{is_active:e.is_active,overstay_limit:e.overstay_limit},zone_group:e.zone_group_id};return r.a.patch("".concat(i,"/zones/").concat(t),o).then((function(t){return t.data})).then((function(t){return t.zone_group_id=t.zone_group.id,delete t.zone_group,t}))}function y(t){return r.a.post("".concat(i,"/zones/groups"),t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){return t.data}))}function v(t,e){return r.a.patch("".concat(i,"/zones/groups/").concat(t),e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){return t.data}))}function _(){return r.a.get("".concat(i,"/zones/?all=true")).then((function(t){return t.data}))}function b(t){return t.response?t.response.data:t.request?"Error while processing request!":t.message?t.message:"UNKNOWN"}function w(t){switch(t){case a.UNKNOWN:return"Unknown person";case a.UNAUTHORIZED:return"Unauthorized";case a.OVERSTAY:return"Overstay";default:return"UNKNOWN ALERT"}}e["b"]={getZones:s,getAllZones:_,getZonesByName:c,getPeopleForZone:p,getAlertsForZone:f,dismissAlert:m,getPeopleWihtinDateTimeRange:l,getPeopleWihtinDate:d,getPeopleCountHourlyInZone:u,createZone:h,editZone:g,createZoneGroup:y,editZoneGroup:v,handleApiError:b,BASE_URL:i}},afbb:function(t,e,o){"use strict";o("a15b"),o("d81d"),o("8a79");function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"file.csv",n=o;n.toLowerCase().endsWith(".csv")||(n+=".csv");var r="data:text/csv;charset=utf-8,";e.length>0&&(r+=e.join(",")+"\n"),r+=t.map((function(t){return t.join(",")})).join("\n");var a=document.createElement("a");a.setAttribute("href",encodeURI(r)),a.setAttribute("download",o),document.body.appendChild(a),a.click(),document.body.removeChild(a)}e["a"]={methods:{exportCsv:n}}},c486:function(t,e,o){"use strict";o.r(e);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("2b0e"),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-layout",{attrs:{view:"lHh Lpr lFf"}},[o("q-header",[o("q-toolbar",[o("q-toolbar-title",[t._v("People Historical")])],1)],1),o("q-page-container",[o("q-page",{attrs:{padding:""}},[o("div",{staticClass:"row"},[o("div",{staticClass:"col"},[o("q-select",{attrs:{label:"Zone",disabled:t.isLoading,loading:t.isZonesLoading,options:t.zones,"option-label":"name","option-value":"id",dense:"","options-dense":"",autofocus:"","use-input":"","input-debounce":"0"},on:{filter:t.zoneFilterFn},scopedSlots:t._u([{key:"option",fn:function(e){return[o("q-item",t._g(t._b({},"q-item",e.itemProps,!1),e.itemEvents),[o("q-item-section",[o("q-item-label",{attrs:{overline:""}},[t._v(t._s(e.opt.name))]),o("q-item-label",[t._v("Group: "+t._s(e.opt.group_name))])],1)],1)]}},{key:"no-option",fn:function(){return[o("q-item",[o("q-item-section",{staticClass:"text-gray"},[t._v(" No Results ")])],1)]},proxy:!0}]),model:{value:t.zone,callback:function(e){t.zone=e},expression:"zone"}})],1),o("div",{staticClass:"col"},[o("q-input",{attrs:{dense:"",value:t.formDateDisplay,label:"Date",readonly:""},scopedSlots:t._u([{key:"append",fn:function(){return[o("q-icon",{staticClass:"cursor-pointer",attrs:{name:"mdi-event"}},[o("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[o("q-date",{attrs:{options:function(e){return e<=t.maxDate},"today-btn":"",mask:"YYYY-MM-DD"},on:{input:function(){return t.$refs.qDateProxy.hide()}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1)]},proxy:!0},{key:"after",fn:function(){return[o("q-toggle",{attrs:{dense:""},model:{value:t.wholeDay,callback:function(e){t.wholeDay=e},expression:"wholeDay"}},[o("q-tooltip",[t._v("Whole Day")])],1)]},proxy:!0}])})],1),t.wholeDay?t._e():o("div",{staticClass:"col-1"},[o("q-input",{attrs:{dense:"",label:"From",value:t.fromHourDisplay,readonly:""},scopedSlots:t._u([{key:"append",fn:function(){return[o("q-icon",{staticClass:"cursor-pointer",attrs:{name:"mdi-clock"}},[o("q-popup-proxy",{ref:"qFromHourProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[o("q-time",{attrs:{format24h:"",options:function(e){return e<=t.toHour},"minute-options":[0]},on:{input:t.closeFromHourPicker},model:{value:t.fromHour,callback:function(e){t.fromHour=e},expression:"fromHour"}})],1)],1)]},proxy:!0}],null,!1,853322532)})],1),t.wholeDay?t._e():o("div",{staticClass:"col-1"},[o("q-input",{attrs:{dense:"",label:"To",value:t.toHourDisplay,readonly:""},scopedSlots:t._u([{key:"append",fn:function(){return[o("q-icon",{staticClass:"cursor-pointer",attrs:{name:"mdi-clock"}},[o("q-popup-proxy",{ref:"qToHourProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[o("q-time",{attrs:{format24h:"",options:function(e){return e>=t.fromHour},"minute-options":[0]},on:{input:t.closeToHourPicker},model:{value:t.toHour,callback:function(e){t.toHour=e},expression:"toHour"}})],1)],1)]},proxy:!0}],null,!1,3074030374)})],1),o("div",{staticClass:"col"},[o("q-btn-group",{attrs:{push:""}},[o("q-btn",{attrs:{push:"",icon:"mdi-refresh",label:"Get Data",size:"md",disabled:t.isLoading||!t.formValid},on:{click:t.getData}}),o("q-btn",{attrs:{push:"",icon:"mdi-file-delimited",label:"Export CSV",size:"md",disabled:t.exportCsvDisabled},on:{click:t.exportToCsv}})],1)],1)]),o("div",{staticClass:"row"},[o("div",{staticClass:"col"},[o("q-table",{attrs:{dense:"",columns:t.columns,data:t.peopleRecords,"row-key":"person_id",loading:t.isLoading},scopedSlots:t._u([{key:"body",fn:function(e){return[o("q-tr",{attrs:{props:e}},[o("q-td",{key:"person_id",attrs:{props:e}},[t._v(" "+t._s(e.row.person_id)+" ")]),o("q-td",{key:"avatar",attrs:{props:e}},[o("q-avatar",{attrs:{color:"indigo"}},[null!==e.row.avatar?o("img",{attrs:{src:e.row.avatar,alt:"person-"+e.row.person_id+"-"+(e.row.is_known?e.row.person_name:"UNKNOWN")}}):o("span",{staticClass:"text-white headline"},[e.row.is_known?[t._v(t._s(e.row.person_name.match(/\b(\w)/g).join("")))]:[t._v("U")]],2)])],1),o("q-td",{key:"name",attrs:{props:e}},[e.row.is_known?o("span",[t._v(t._s(e.row.person_name))]):o("span",{staticClass:"text-red"},[t._v("UNKNOWN")])]),o("q-td",{key:"from",attrs:{props:e}},[t._v(" "+t._s(t._f("formatDateTime")(e.row.from))+" ")]),o("q-td",{key:"to",attrs:{props:e}},[null===e.row.to?o("span",[t._v("-")]):o("span",[t._v(t._s(t._f("formatDateTime")(e.row.to)))])])],1)]}}])})],1)])])],1)],1)},a=[],i=(o("99af"),o("d81d"),o("ac1f"),o("5319"),o("1315")),s=o("365c"),c=o("afbb"),u=o("144e"),l=[{label:"ID",name:"person_id",field:"person_id",required:!0},{label:"Foto",align:"center",name:"avatar",field:"avatar",sortable:!1},{label:"Nama",align:"left",name:"name",field:"person_name",sortable:!0},{label:"Waktu Masuk",name:"from",field:"from",sortable:!0,sort:function(t,e){return e-t}},{label:"Waktu Keluar",name:"to",field:"to",sortable:!0,sort:function(t,e){return null===t?1:null===e?-1:e-t}}];function d(t){return t<10?"0".concat(t,":00"):"".concat(t,":00")}var p={mixins:[c["a"],u["a"]],data:function(){var t=i["DateTime"].local().startOf("hour");return{maxDate:t.toFormat("yyyy-LL-dd"),wholeDay:!1,zones:[],zone:null,isZonesLoading:!1,date:t.toFormat("yyyy-LL-dd"),fromHour:t.hour,toHour:t.hour,isLoading:!1,peopleRecords:[],columns:l}},computed:{formDateDisplay:function(){return i["DateTime"].fromFormat(this.date,"yyyy-LL-dd").toFormat("dd LLL yyyy")},fromHourDisplay:function(){return d(this.fromHour)},toHourDisplay:function(){return d(this.toHour)},exportCsvDisabled:function(){return this.isLoading||0===this.peopleRecords.length},formValid:function(){return null!==this.zone}},methods:{closeFromHourPicker:function(t,e){this.fromHour=e.hour,this.$refs.qFromHourProxy.hide()},closeToHourPicker:function(t,e){this.toHour=e.hour,this.$refs.qToHourProxy.hide()},zoneFilterFn:function(t,e){var o=this;this.isZonesLoading||(this.isZonesLoading=!0,s["b"].getZonesByName(t).then((function(t){o.isZonesLoading=!1,e((function(){o.zones=t}))})).catch((function(t){o.isZonesLoading=!1,o.showError(t.message)})))},getData:function(){var t=this;if(!this.isLoading){this.isLoading=!0;var e,o=this;if(this.wholeDay)e=s["b"].getPeopleWihtinDate(this.zone.id,this.date);else{var n="".concat(this.date,"T").concat(d(this.fromHour)),r="".concat(this.date,"T").concat(d(this.toHour));e=s["b"].getPeopleWihtinDateTimeRange(this.zone.id,n,r)}e.then((function(t){o.peopleRecords=t,o.isLoading=!1})).catch((function(e){o.isLoading=!1,t.showError(e.message)}))}},exportToCsv:function(){var t,e="yyyy-MM-dd HH:mm:ss",o=this.peopleRecords.map((function(t){return[t.person_id,t.is_known?t.person_name:"UNKNOWN",i["DateTime"].fromJSDate(t.from).toFormat(e),null!==t.to?i["DateTime"].fromJSDate(t.to).toFormat(e):"NULL"]})),n=["id","name","from","to"],r=this.date.replace(/-/g,"");if(this.wholeDay)t="".concat(r,"_zone-people-historical.csv");else{var a=this.fromHour<10?"0".concat(this.fromHour):"".concat(this.fromHour),s=this.toHour<10?"0".concat(this.toHour):"".concat(this.toHour);t="".concat(r,"_").concat(a).concat(s,"_zone-people-historical.csv")}this.exportCsv(o,n,t)},showError:function(t){this.$q.notify({type:"warning",message:t})}}},f=p,m=o("2877"),h=o("fe09"),g=Object(m["a"])(f,r,a,!1,null,null,null),y=g.exports;g.options.components=Object.assign({QLayout:h["k"],QHeader:h["e"],QToolbar:h["t"],QToolbarTitle:h["u"],QPageContainer:h["m"],QPage:h["l"],QSelect:h["o"],QItem:h["h"],QItemSection:h["j"],QItemLabel:h["i"],QInput:h["g"],QIcon:h["f"],QPopupProxy:h["n"],QDate:h["d"],QToggle:h["s"],QTooltip:h["v"],QTime:h["r"],QBtnGroup:h["c"],QBtn:h["b"],QTable:h["p"],QTr:h["w"],QTd:h["q"],QAvatar:h["a"]},g.options.components||{});o("0e21");var v=o("8e37"),_=(o("9f29"),o("b05d")),b=o("2a19");n["a"].use(_["a"],{config:{},components:{},directives:{},plugins:{Notify:b["a"]},iconSet:v["a"]}),n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(y)}}).$mount("#app")}});
//# sourceMappingURL=zonePeopleHistorical.e8cf313f.js.map